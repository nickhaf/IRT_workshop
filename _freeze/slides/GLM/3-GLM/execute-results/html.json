{
  "hash": "79694280b371b440f53a2f458ee7263a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Algemeines Linear Gemischtes Modell (ALGM)\nsubtitle: \"Das Raschmodell als eine Spezialfall des ALGM\"\nauthor: \"Nicklas Hafiz\"\ndate: \"2024 August, 14\"\nformat: \n  letterbox-revealjs:\n    embed-resources: true\n---\n\n\n## Überblick\n- Generalized Linear Modell (GLM)\n- Linear Mixed Model (LMM) \n- Übertragung auf IRT Kontext\n\n## Generalized Linear Model\n\n$$\ny = Xb+e\n$$\n\n$$\nE(y) = \\mu = g^{-1}(Xb)\n$$\n\n- mit $g$ als Link Funktion\n\nVarianzfunktion auch zeigen?\n\n## IRT Modell als GLM\n$$\ng(\\mu) = ln(\\frac{\\mu}{1-\\mu}) = Xb\n$$\n\n## IRT Modell als GLM\n- Logistische Regression: Modellierung der Wahrscheinlichkeit einer korrekten Antwort. \n- Zusammenhang der Variablen linear. Muss dann noch auf die logit-scale gebracht werden (Link Funktion).\n-  \n\n\n## {background-image=\"images/hogwarts.jpg\" background-size=\"1250px\"}\n\n::: {.absolute left=\"15%\" top=\"5%\" style=\"font-size:2em; padding: 0.5em 0.5em; background-color: rgba(255, 255, 255, .7); backdrop-filter: blur(5px); box-shadow: 0 0 1rem 0 rgba(255, 255, 255, .5); border-radius: 5px;\"}\n\nLinear Mixed Models\n\n:::\n\n::: aside\nFoto von [Mauro Lima](https://unsplash.com/de/@limamauro23?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash) auf [Unsplash](https://unsplash.com/de/fotos/eine-burg-aus-felsen-mit-einem-bewolkten-himmel-im-hintergrund-k2TgEJZ65D0?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash).\n\n:::\n\n## LLM\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\n## Daten laden\nload(here::here(\"raw_data\", \"multilevel_data.rda\"))\n\n## Überblick\nstr(stud_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [7,185 × 5] (S3: tbl_df/tbl/data.frame)\n $ school  : chr [1:7185] \"1224\" \"1224\" \"1224\" \"1224\" ...\n $ minority: Factor w/ 2 levels \"No\",\"Yes\": 1 1 1 1 1 1 1 1 1 1 ...\n $ sex     : Factor w/ 2 levels \"Male\",\"Female\": 2 2 1 1 1 1 2 1 2 1 ...\n $ ses     : num [1:7185] -1.528 -0.588 -0.528 -0.668 -0.158 ...\n $ mathach : num [1:7185] 5.88 19.71 20.35 8.78 17.9 ...\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n\n::: aside\nDaten aus diesem [Tutorial](https://raffaelevacca.github.io/Intro-multilevel-with-R/)\n:::\n\n\n\n# Umgang mit genesteten Daten\n\n## Option 1: Ignorieren\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](3-GLM_files/figure-revealjs/unnamed-chunk-3-1.png){width=960}\n:::\n:::\n\n\n## Option 1: Ignorieren\n\nGenerell eher keine gute Idee:\n\n- Die genestete Struktur kann von Interesse sein!\n- Wir tun so, als ob wir mehr Informationen hätten, als wir letztendlich haben. Das liegt daran, dass Abhängigkeiten zwischen den Daten bestehen. Konsequenz:    \n\n\nStandardfehler werden unterschätzt, unsere Inferenzstatistischen Tests werden eher signifikant. \n\n\n\n## Option 2: Aggregieren\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](3-GLM_files/figure-revealjs/unnamed-chunk-4-1.png){width=960}\n:::\n:::\n\n\n## Option 2: Aggregieren\n\n\n## Option 3: Disaggregiert Analyse mit Gruppen als Prädiktoren\nVerstehe noch nicht so ganz, wie das grafisch aussehen würde. \nhttps://www.cambridge.org/core/journals/political-science-research-and-methods/article/abs/should-i-use-fixed-or-random-effects/12DFCB222123587A37163F2226E85C67\n\nrandom effect models reduce bias, but can reduce the variance of estimates of coefficients of interest. some sort of regularization\n\n\n::: {.cell}\n\n:::\n\n\nWird schnell unübersichtlich, lm z.B. gibt uns viele Infos raus, die uns eigentlich gar nicht interssieren. \nAn sich müsste die Grafik ähnlich aussehen wie im nächsten Beispiel? Die Berechnungen sind aber ein bisscehn anders, v.a. wegen Partial pooling. \n\n## Option 3: Disaggregiert Analyse mit Gruppen als Prädiktoren\n\n\n## Option 4: Multilevel-Modell\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](3-GLM_files/figure-revealjs/unnamed-chunk-6-1.png){width=960}\n:::\n:::\n\n\n\n## Notizen \n\nRein Optisch betrachtet scheint es recht wichtig zu sein, auf welche Schule man geht. Die Abweichung von Mittelwert des GesamtSES hat auch einen Einfluss. \n\n# Gleichungen\n## Level 1 Gleichung\n\nFür jede Gruppe j:\n$$\ny_{ij} = \\beta_{0j} + \\beta_{1j}x_{ij} + e_{ij}\n$$\n\nAbbildung \n\n## Level-2 Gleichung\n\n$$\n\\beta_{0j} = \\beta_{0}+\\zeta_{0j}\n$$\n\n$$\n\\beta_{1j} = \\beta_1 + \\zeta_{1j}\n$$\n\nAbbildung\n\n## Das gemischte Modell\nJetzt müssen wir nur noch einsetzen:\n\n\n$$\ny_{ij} = \\beta_{0j} + \\beta_{1j}x_{ij} + e_{ij}\n$$\n$$\n\\beta_{0j} = \\beta_{0}+\\zeta_{0j}\n$$\n\n$$\n\\beta_{1j} = \\beta_1 + \\zeta_{1j}\n$$\n\n$$\ny_{ij} = \\beta_{0}+\\beta_1x_{ij} + \\zeta_{0j} + \\zeta_{1j}x_{ij} + e_{ij}\n$$\n\n\n## \n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n\n**Random** effects\n\n\\\n\\\n\n ![](images/dice.jpg)\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {layout-ncol=1}\n\n ![](images/screws.jpg)\n \n \\\n \\\n\n **Fixed** effects\n\n:::\n\n:::\n\n::::\n\n## Random und Fixed effects\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n**Random Effects**\n\n- Annahme eines zugrundeliegenden Gesamtmittelwerts. Von diesem weichen die Gruppen **random** ab. \n- Bei Wiederholung würden wir andere Gruppen ziehen. \n- Partial Pooling: Regularisierung der Extremen Werte in Richtung Gruppenmittelwert. \n<!-- - Anders ausgedrückt: Wir nehmen an, dass die Gruppen aus einer Grundverteilung gezogen wurden. Wir hätten theoretisch aber auch andere Gruppen ziehen können: Wenn wir das Experiment wiederholen, die level auf diesem Faktor werden andere sein.\n- Dadurch können wir Informationen aus den Anderen Gruppen ebenfalls nutzen.  -->\n\n:::\n\n\n::: {.column width=\"50%\"}\n**Fixed Effects**\n\n- Hier machen wir diese Annahme einfach nicht. \n- Uns interessieren die tatsächlichen Gruppen, bei Wiederholung würden wird die gleichen ziehen.\n\n:::\n\n\n::::\n\n## Beispiel\n\nWir untersuchen den Erfolg von Verhaltenstherapie und Psychoanalyse anhand der Rückfallquote nach einem Jahr.  \nPatient*innen müssen hier nach Therapeut*innen genested werden. Dabei können wir die Therapeut*innen als random effects betrachten, wir haben sie ja schließlich nur als Mittel zum Zweck aus der Population an Therapeut*innen gezogen. Die Behandlungsform (Verhaltenstherapie, Psychoanalyse) ist hingegen ein fixed effect, da wir nur diese beiden Behandlungsformen untersuchen wollen.\n\nAnders würde das Ganze aussehen, wenn uns die Erfolgsquote speziell dieser Therapeut*innen interessieren würde. Dann könnten wir sie ebenfalls als fixed effect im Modell mit aufnehmen. \n\n\n\n## lme4\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lme4)\n\nmod1 <- lmer(mathach ~ ses_cent + (1|school), data = illustration_dat) \nsummary(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: mathach ~ ses_cent + (1 | school)\n   Data: illustration_dat\n\nREML criterion at convergence: 2091\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-2.52568 -0.67053 -0.06796  0.74859  2.79564 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n school   (Intercept)  8.778   2.963   \n Residual             34.699   5.891   \nNumber of obs: 325, groups:  school, 9\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)  13.1169     1.0447  12.555\nses_cent      2.6255     0.5285   4.968\n\nCorrelation of Fixed Effects:\n         (Intr)\nses_cent -0.016\n```\n\n\n:::\n:::\n\n\n\n# Raschmodell als LMM\nWarum das Ganze? Es geht doch eigentlich um IRT?\n\n## Raschmodell als Spezialfall von LMM\n\nDafür müssen wir zwei Dinge beachten:\n- Link Funktion.  \n- Entscheidung über Annahme von fixed/random effects von Personen und Items.\n\n::: aside\n- De Boeck and Wilson (2004)\n- Doran et al. (2007)\n:::\n\n\n## Link Funktion\n\n\n\n## Fixed und Random Effects\n\n- Entwicklung Fragebogen um diesen an verschiedenen Stichproben zu nutzen: Person als random, Items als fixed\n- Entwicklung von Items für einen großen Fragenkatalog: Items ebenfalls als random\n\n\n## Exercise \n- Direkt übertragen auf den IRT-KOntext? Also sagen: Nehmt die Daten aus dem letzten Beispiel und fittet ein LLM Modell. \n- Dann Vergleich mit TAM.\n\n\n## Prädiktoren\n- Beispiel aufgreifen, zeigen, wass man mit diesen Modell noch machen kann. \n\n\n",
    "supporting": [
      "3-GLM_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}